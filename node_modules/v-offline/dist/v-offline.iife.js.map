{"version":3,"file":"v-offline.iife.js","sources":["../src/VOffline.vue","../src/install.ts"],"sourcesContent":["<template>\n  <div :class=\"wrapperClass\">\n    <slot />\n  </div>\n</template>\n\n<script lang=\"ts\">\n  import Ping from 'ping.js';\n  import { computed, defineComponent, onBeforeUnmount, ref } from 'vue';\n  import type { ComputedRef, PropType, Ref, SetupContext } from 'vue';\n\n  type VOfflineProps = {\n    onlineClass?: string;\n    offlineClass?: string;\n    pingUrl?: string;\n  };\n\n  export default defineComponent({\n    name: 'VOffline',\n    props: {\n      onlineClass: {\n        type: String as PropType<string>,\n        required: false,\n        default: '',\n      },\n      offlineClass: {\n        type: String as PropType<string>,\n        required: false,\n        default: '',\n      },\n      pingUrl: {\n        type: String as PropType<string>,\n        required: false,\n        default: 'https://google.com',\n      },\n    },\n    setup(props: VOfflineProps, { emit }: SetupContext) {\n      // Local state\n      const isOnline: Ref<boolean> = ref(navigator.onLine || false);\n      const events: Ref<string[]> = ref(['online', 'offline', 'load']);\n      const url: Ref<string> = ref(props.pingUrl || 'https://google.com');\n\n      // Local computed\n      const wrapperClass: ComputedRef<string> = computed(() => {\n        if (isOnline.value) {\n          return typeof props.onlineClass === 'string' ? props.onlineClass : '';\n        } else {\n          return typeof props.offlineClass === 'string'\n            ? props.offlineClass\n            : '';\n        }\n      });\n\n      /**\n       * Created lifecycle hook\n       */\n      events.value.forEach((event: string) =>\n        window.addEventListener(event, check),\n      );\n\n      /**\n       * Before unmount lifecycle hook\n       */\n      onBeforeUnmount(() => {\n        // Cleanup of the event listeners\n        events.value.forEach((event: string) =>\n          window.removeEventListener(event, check),\n        );\n      });\n\n      // Local functions\n      /**\n       * Pings the URL and emits an\n       * detected online/offline event.\n       *\n       * @returns {Promise<void>}\n       */\n      async function check(): Promise<void> {\n        const p = new Ping();\n        try {\n          const ping = await p.ping(url.value);\n          if (ping || navigator.onLine) {\n            isOnline.value = true;\n            emit('detected-condition', isOnline.value);\n          }\n        } catch (error) {\n          if (error || !navigator.onLine) {\n            isOnline.value = false;\n            emit('detected-condition', isOnline.value);\n          }\n        }\n      }\n\n      return {\n        wrapperClass,\n      };\n    },\n  });\n</script>\n","import { VueConstructor } from 'vue';\nimport VOffline from './VOffline.vue';\n\nlet installed = false;\n\nconst install = {\n  install(Vue: VueConstructor): void {\n    if (installed) return;\n    Vue.component('VOffline', VOffline);\n    installed = true;\n  },\n};\n\nexport default install;\n"],"names":["_sfc_main","defineComponent","props","emit","isOnline","ref","events","url","wrapperClass","computed","event","check","onBeforeUnmount","p","Ping","error","installed","install","Vue","VOffline"],"mappings":";;;;+GAiBAA,EAAAC,kBAAA,CACA,KAAA,WACA,MAAA,CACA,YAAA,CACA,KAAA,OACA,SAAA,GACA,QAAA,EACA,EACA,aAAA,CACA,KAAA,OACA,SAAA,GACA,QAAA,EACA,EACA,QAAA,CACA,KAAA,OACA,SAAA,GACA,QAAA,oBACA,CACA,EACA,MAAAC,EAAA,CAAA,KAAAC,GAAA,CAEA,MAAAC,EAAAC,EAAA,IAAA,UAAA,QAAA,EAAA,EACAC,EAAAD,EAAAA,IAAA,CAAA,SAAA,UAAA,MAAA,CAAA,EACAE,EAAAF,EAAA,IAAAH,EAAA,SAAA,oBAAA,EAGAM,EAAAC,EAAAA,SAAA,IACAL,EAAA,MACA,OAAAF,EAAA,aAAA,SAAAA,EAAA,YAAA,GAEA,OAAAA,EAAA,cAAA,SACAA,EAAA,aACA,EAEA,EAKAI,EAAA,MAAA,QAAAI,GACA,OAAA,iBAAAA,EAAAC,CAAA,CAAA,EAMAC,EAAAA,gBAAA,IAAA,CAEAN,EAAA,MAAA,QAAAI,GACA,OAAA,oBAAAA,EAAAC,CAAA,CAAA,CACA,CACA,EASA,eAAAA,GAAA,CACA,MAAAE,EAAA,IAAAC,EAAAA,QACA,GAAA,EACA,MAAAD,EAAA,KAAAN,EAAA,KAAA,GACA,UAAA,UACAH,EAAA,MAAA,GACAD,EAAA,qBAAAC,EAAA,KAAA,SAEAW,IACAA,GAAA,CAAA,UAAA,UACAX,EAAA,MAAA,GACAD,EAAA,qBAAAC,EAAA,KAAA,EAEA,CACA,CAEA,MAAA,CACA,aAAAI,CAAA,CAEA,CACA,CAAA,s5BC9FA,IAAIQ,EAAY,GAEhB,MAAMC,EAAU,CACd,QAAQC,EAA2B,CAC7BF,IACAE,EAAA,UAAU,WAAYC,CAAQ,EACtBH,EAAA,GACd,CACF"}