{"version":3,"file":"index.umd.js","sources":["../src/form.js","../src/link.js","../src/remember.js","../src/app.js"],"sourcesContent":["import { Inertia } from '@inertiajs/inertia'\n\nexport default function(data = {}) {\n  const defaults = JSON.parse(JSON.stringify(data))\n  let recentlySuccessfulTimeoutId = null\n  let transform = data => data\n\n  return {\n    ...defaults,\n    errors: {},\n    hasErrors: false,\n    processing: false,\n    progress: null,\n    wasSuccessful: false,\n    recentlySuccessful: false,\n    data() {\n      return Object\n        .keys(data)\n        .reduce((carry, key) => {\n          carry[key] = this[key]\n          return carry\n        }, {})\n    },\n    transform(callback) {\n      transform = callback\n\n      return this\n    },\n    reset(...fields) {\n      if (fields.length === 0) {\n        Object.assign(this, defaults)\n      } else {\n        Object.assign(\n          this,\n          Object\n            .keys(defaults)\n            .filter(key => fields.includes(key))\n            .reduce((carry, key) => {\n              carry[key] = defaults[key]\n              return carry\n            }, {}),\n        )\n      }\n\n      return this\n    },\n    clearErrors(...fields) {\n      this.errors = Object\n        .keys(this.errors)\n        .reduce((carry, field) => ({\n          ...carry,\n          ...(fields.length > 0 && !fields.includes(field) ? { [field] : this.errors[field] } : {}),\n        }), {})\n\n      this.hasErrors = Object.keys(this.errors).length > 0\n\n      return this\n    },\n    serialize() {\n      return {\n        errors: this.errors,\n        ...this.data(),\n      }\n    },\n    unserialize(data) {\n      Object.assign(this, data)\n      this.hasErrors = Object.keys(this.errors).length > 0\n    },\n    submit(method, url, options = {}) {\n      const data = transform(this.data())\n      const _options = {\n        ...options,\n        onBefore: visit => {\n          this.wasSuccessful = false\n          this.recentlySuccessful = false\n          clearTimeout(recentlySuccessfulTimeoutId)\n\n          if (options.onBefore) {\n            return options.onBefore(visit)\n          }\n        },\n        onStart: visit => {\n          this.processing = true\n\n          if (options.onStart) {\n            return options.onStart(visit)\n          }\n        },\n        onProgress: event => {\n          this.progress = event\n\n          if (options.onProgress) {\n            return options.onProgress(event)\n          }\n        },\n        onSuccess: page => {\n          this.clearErrors()\n          this.wasSuccessful = true\n          this.recentlySuccessful = true\n          recentlySuccessfulTimeoutId = setTimeout(() => this.recentlySuccessful = false, 2000)\n\n          if (options.onSuccess) {\n            return options.onSuccess(page)\n          }\n        },\n        onError: errors => {\n          this.errors = errors\n          this.hasErrors = true\n\n          if (options.onError) {\n            return options.onError(errors)\n          }\n        },\n        onFinish: () => {\n          this.processing = false\n          this.progress = null\n\n          if (options.onFinish) {\n            return options.onFinish()\n          }\n        },\n      }\n\n      if (method === 'delete') {\n        Inertia.delete(url, { ..._options, data  })\n      } else {\n        Inertia[method](url, data, _options)\n      }\n    },\n    post(url, options) {\n      this.submit('post', url, options)\n    },\n    put(url, options) {\n      this.submit('put', url, options)\n    },\n    patch(url, options) {\n      this.submit('patch', url, options)\n    },\n    delete(url, options) {\n      this.submit('delete', url, options)\n    },\n  }\n}\n","import { hrefToUrl, Inertia, mergeDataIntoQueryString, shouldIntercept } from '@inertiajs/inertia'\n\nexport default {\n  functional: true,\n  props: {\n    as: {\n      type: String,\n      default: 'a',\n    },\n    data: {\n      type: Object,\n      default: () => ({}),\n    },\n    href: {\n      type: String,\n      required: true,\n    },\n    method: {\n      type: String,\n      default: 'get',\n    },\n    replace: {\n      type: Boolean,\n      default: false,\n    },\n    preserveScroll: {\n      type: Boolean,\n      default: false,\n    },\n    preserveState: {\n      type: Boolean,\n      default: null,\n    },\n    only: {\n      type: Array,\n      default: () => [],\n    },\n    headers: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  render(h, { props, data, children }) {\n    data.on = {\n      click: () => ({}),\n      cancelToken: () => ({}),\n      start: () => ({}),\n      progress: () => ({}),\n      finish: () => ({}),\n      cancel: () => ({}),\n      success: () => ({}),\n      error: () => ({}),\n      ...(data.on || {}),\n    }\n\n    const as = props.as.toLowerCase()\n    const method = props.method.toLowerCase()\n    const [url, propsData] = mergeDataIntoQueryString(method, hrefToUrl(props.href), props.data)\n\n    if (as === 'a' && method !== 'get') {\n      console.warn(`Creating POST/PUT/PATCH/DELETE <a> links is discouraged as it causes \"Open Link in New Tab/Window\" accessibility issues.\\n\\nPlease specify a more appropriate element using the \"as\" attribute. For example:\\n\\n<inertia-link href=\"${url.href}\" method=\"${method}\" as=\"button\">...</inertia-link>`)\n    }\n\n    return h(props.as, {\n      ...data,\n      attrs: {\n        ...data.attrs,\n        ...as === 'a' ? { href: url.href } : {},\n      },\n      on: {\n        ...data.on,\n        click: event => {\n          data.on.click(event)\n\n          if (shouldIntercept(event)) {\n            event.preventDefault()\n\n            Inertia.visit(url.href, {\n              data: propsData,\n              method: method,\n              replace: props.replace,\n              preserveScroll: props.preserveScroll,\n              preserveState: props.preserveState ?? (method !== 'get'),\n              only: props.only,\n              headers: props.headers,\n              onCancelToken: data.on.cancelToken,\n              onBefore: data.on.before,\n              onStart: data.on.start,\n              onProgress: data.on.progress,\n              onFinish: data.on.finish,\n              onCancel: data.on.cancel,\n              onSuccess: data.on.success,\n              onError: data.on.error,\n            })\n          }\n        },\n      },\n    }, children)\n  },\n}\n","import { Inertia } from '@inertiajs/inertia'\n\nexport default {\n  created() {\n    if (!this.$options.remember) {\n      return\n    }\n\n    if (Array.isArray(this.$options.remember)) {\n      this.$options.remember = { data: this.$options.remember }\n    }\n\n    if (typeof this.$options.remember === 'string') {\n      this.$options.remember = { data: [this.$options.remember] }\n    }\n\n    if (typeof this.$options.remember.data === 'string') {\n      this.$options.remember = { data: [this.$options.remember.data] }\n    }\n\n    const stateKey = this.$options.remember.key instanceof Function\n      ? this.$options.remember.key.call(this)\n      : this.$options.remember.key\n\n    const restored = Inertia.restore(stateKey)\n\n    this.$options.remember.data.forEach(key => {\n      if (this[key] !== undefined && restored !== undefined && restored[key] !== undefined) {\n        typeof this[key].serialize === 'function' && typeof this[key].unserialize === 'function'\n          ? this[key].unserialize(restored[key])\n          : (this[key] = restored[key])\n      }\n\n      this.$watch(key, () => {\n        Inertia.remember(\n          this.$options.remember.data.reduce((carry, key) => ({\n            ...carry,\n            [key]: typeof this[key].serialize === 'function' && typeof this[key].unserialize === 'function'\n              ? this[key].serialize()\n              : this[key],\n          }), {}),\n          stateKey,\n        )\n      }, { immediate: true, deep: true })\n    })\n  },\n}\n","import form from './form'\nimport link from './link'\nimport remember from './remember'\nimport { Inertia } from '@inertiajs/inertia'\n\nlet app = {}\n\nexport default {\n  name: 'Inertia',\n  props: {\n    initialPage: {\n      type: Object,\n      required: true,\n    },\n    resolveComponent: {\n      type: Function,\n      required: true,\n    },\n    resolveErrors: {\n      type: Function,\n      required: false,\n    },\n    transformProps: {\n      type: Function,\n      required: false,\n    },\n  },\n  data() {\n    return {\n      component: null,\n      page: {},\n      key: null,\n    }\n  },\n  created() {\n    app = this\n    Inertia.init({\n      initialPage: this.initialPage,\n      resolveComponent: this.resolveComponent,\n      resolveErrors: this.resolveErrors,\n      transformProps: this.transformProps,\n      swapComponent: async ({ component, page, preserveState }) => {\n        this.component = component\n        this.page = page\n        this.key = preserveState ? this.key : Date.now()\n      },\n    })\n  },\n  render(h) {\n    if (this.component) {\n      const child = h(this.component, {\n        key: this.key,\n        props: this.page.props,\n        scopedSlots: this.$scopedSlots,\n      })\n\n      if (this.component.layout) {\n        if (typeof this.component.layout === 'function') {\n          return this.component.layout(h, child)\n        } else if (Array.isArray(this.component.layout)) {\n          return this.component.layout\n            .concat(child)\n            .reverse()\n            .reduce((child, layout) => h(layout, [child]))\n        }\n\n        return h(this.component.layout, [child])\n      }\n\n      return child\n    }\n  },\n  install(Vue) {\n    console.warn('Registering the Inertia Vue plugin via the \"app\" component has been deprecated. Use the new \"plugin\" named export instead.\\n\\nimport { plugin } from \\'@inertiajs/inertia-vue\\'\\n\\nVue.use(plugin)')\n    plugin.install(Vue)\n  },\n}\n\nexport const plugin = {\n  install(Vue) {\n    Inertia.form = form\n    Object.defineProperty(Vue.prototype, '$inertia', { get: () => Inertia })\n    Object.defineProperty(Vue.prototype, '$page', { get: () => app.page })\n    Vue.mixin(remember)\n    Vue.component('InertiaLink', link)\n  },\n}\n"],"names":["data","defaults","JSON","parse","stringify","recentlySuccessfulTimeoutId","transform","errors","hasErrors","processing","progress","wasSuccessful","recentlySuccessful","Object","keys","reduce","carry","key","_this","callback","reset","fields","assign","this","length","filter","includes","clearErrors","field","_this2","serialize","unserialize","submit","method","url","options","_options","onBefore","visit","_this3","clearTimeout","onStart","onProgress","event","onSuccess","page","setTimeout","onError","onFinish","Inertia","post","put","patch","functional","props","as","type","String","default","href","required","replace","Boolean","preserveScroll","preserveState","only","Array","headers","render","h","children","on","click","cancelToken","start","finish","cancel","success","error","toLowerCase","mergeDataIntoQueryString","hrefToUrl","propsData","console","warn","attrs","shouldIntercept","preventDefault","onCancelToken","before","onCancel","created","$options","remember","isArray","stateKey","Function","call","restored","restore","forEach","undefined","$watch","immediate","deep","app","name","initialPage","resolveComponent","resolveErrors","transformProps","component","init","swapComponent","Date","now","child","scopedSlots","$scopedSlots","layout","concat","reverse","install","Vue","plugin","form","defineProperty","prototype","get","mixin","link"],"mappings":"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"}